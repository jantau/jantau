#----------------------------------------------------------------------------
# Transform data
#----------------------------------------------------------------------------
dax_transform <- dax %>%
drop_na() %>%
select(1, 2, 3) %>%
mutate(ym = substr(date, 1, 7)) %>%
mutate(day = substr(date, 9, 10)) %>%
mutate(weekday = weekdays.POSIXt(date, abbreviate = TRUE)) %>%
mutate(weekday = factor(weekday, levels = c("Mon", "Tue", "Wed", "Thu", "Fri"))) %>%
group_by(ym) %>%
mutate(trading_day = row_number()) %>%
filter(trading_day <= 18) %>% # all months have at least 17 trading days
mutate(rank = rank(open, ties.method = "random"))
dax_transform %>%
filter(rank <= 1)  %>%
ggplot(aes(x = trading_day)) +
geom_bar()
#----------------------------------------------------------------------------
# Transform data
#----------------------------------------------------------------------------
dax_transform <- dax %>%
drop_na() %>%
select(1, 2, 3) %>%
mutate(ym = substr(date, 1, 7)) %>%
mutate(day = substr(date, 9, 10)) %>%
mutate(weekday = weekdays.POSIXt(date, abbreviate = TRUE)) %>%
mutate(weekday = factor(weekday, levels = c("Mon", "Tue", "Wed", "Thu", "Fri"))) %>%
group_by(ym) %>%
mutate(trading_day = row_number()) %>%
filter(trading_day <= 17) %>% # all months have at least 17 trading days
mutate(rank = rank(open, ties.method = "random"))
dax_transform %>%
filter(rank <= 1)  %>%
ggplot(aes(x = trading_day)) +
geom_bar()
#----------------------------------------------------------------------------
# Transform data
#----------------------------------------------------------------------------
dax_transform <- dax %>%
drop_na() %>%
select(1, 2, 3) %>%
mutate(ym = substr(date, 1, 7)) %>%
mutate(day = substr(date, 9, 10)) %>%
mutate(weekday = weekdays.POSIXt(date, abbreviate = TRUE)) %>%
mutate(weekday = factor(weekday, levels = c("Mon", "Tue", "Wed", "Thu", "Fri"))) %>%
group_by(ym) %>%
mutate(trading_day = row_number()) %>%
filter(trading_day <= 18) %>% # all months have at least 17 trading days
mutate(rank = rank(open, ties.method = "random"))
dax_transform %>%
filter(rank <= 1)  %>%
ggplot(aes(x = trading_day)) +
geom_bar()
#----------------------------------------------------------------------------
# Transform data
#----------------------------------------------------------------------------
dax_transform <- dax %>%
drop_na() %>%
select(1, 2, 3) %>%
mutate(ym = substr(date, 1, 7)) %>%
mutate(day = substr(date, 9, 10)) %>%
mutate(weekday = weekdays.POSIXt(date, abbreviate = TRUE)) %>%
mutate(weekday = factor(weekday, levels = c("Mon", "Tue", "Wed", "Thu", "Fri"))) %>%
group_by(ym) %>%
mutate(trading_day = row_number()) %>%
filter(trading_day <= 17) %>% # all months have at least 17 trading days
mutate(rank = rank(open, ties.method = "random"))
dax_transform %>%
filter(rank <= 1)  %>%
ggplot(aes(x = trading_day)) +
geom_bar()
#----------------------------------------------------------------------------
# Transform data
#----------------------------------------------------------------------------
dax_transform <- dax %>%
drop_na() %>%
select(1, 2, 3) %>%
mutate(ym = substr(date, 1, 7)) %>%
mutate(day = substr(date, 9, 10)) %>%
mutate(weekday = weekdays.POSIXt(date, abbreviate = TRUE)) %>%
mutate(weekday = factor(weekday, levels = c("Mon", "Tue", "Wed", "Thu", "Fri"))) %>%
group_by(ym) %>%
mutate(trading_day = row_number()) %>%
#  filter(trading_day <= 17) %>% # all months have at least 17 trading days
mutate(rank = rank(open, ties.method = "random"))
dax_transform %>%
filter(rank <= 1)  %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(rank <= 5)  %>%
group_by(rank) %>%
summarise(n())
dax_transform %>%
filter(rank <= 5)  %>%
filter(trading_day <= 18) %>%
group_by(rank) %>%
summarise(n())
dax_transform %>%
filter(rank <= 1)  %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(rank <= 1)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(rank <= 1)  %>%
group_by(rank) %>%
summarise(mean = mean())
dax_transform %>%
filter(rank <= 1)  %>%
summarise(mean = mean(trading_day))
dax_transform %>%
filter(rank <= 1)  %>%
group_by(rank) %>%
summarise(mean = mean(trading_day))
dax_transform %>%
filter(rank <= 1)  %>%
group_by(trading_day) %>%
summarise(mean = mean(trading_day))
dax_transform %>%
group_by(rank) %>%
summarise(mean = mean(trading_day))
dax_transform %>%
group_by(trading_day) %>%
summarise(mean = mean(rank))
dax_transform %>%
group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
#----------------------------------------------------------------------------
# Transform data
#----------------------------------------------------------------------------
dax_transform <- dax %>%
drop_na() %>%
select(1, 2, 3) %>%
mutate(ym = substr(date, 1, 7)) %>%
mutate(day = substr(date, 9, 10)) %>%
mutate(weekday = weekdays.POSIXt(date, abbreviate = TRUE)) %>%
mutate(weekday = factor(weekday, levels = c("Mon", "Tue", "Wed", "Thu", "Fri"))) %>%
group_by(ym) %>%
mutate(trading_day = row_number()) %>%
#  filter(trading_day <= 17) %>% # all months have at least 17 trading days
mutate(rank = rank(open, ties.method = "random"))
dax_transform %>%
group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
dax_transform %>%
filter(rank <= 1)  %>%
group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
dax_transform %>%
filter(rank <= 1)  %>%
# group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
dax_transform %>%
filter(rank <= 1)  %>%
group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
dax_transform %>%
filter(trading_day <= 1)  %>%
group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
dax_transform %>%
filter(trading_day == 15)  %>%
group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
dax_transform %>%
filter(trading_day == 17)  %>%
group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
dax_mean <- dax_transform %>%
group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
View(dax_mean)
dax_transform %>%
group_by(trading_day) %>%
summarise(mean_rank = mean(rank))
dax_transform %>%
group_by(trading_day) %>%
summarise(first_rank = filter(rank == 1))
dax_transform %>%
group_by(trading_day) %>%
summarise(first_rank = rank == 1)
dax_transform %>%
group_by(trading_day) %>%
summarise(first_rank = n(rank == 1)/n(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
summarise(first_rank = n(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
summarise(first_rank = count(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = count(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = rank != 1)
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = n(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = count(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = count(rank == 1)/count(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = length(rank == 1)/length(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = length(rank == 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = length(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = sum(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = sum(rank == 1)/sum(rank != 1))
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 1) %>%
summarise(first_rank = sum(rank == 1)/sum(rank != 1)*100)
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 2) %>%
summarise(first_rank = sum(rank == 1)/sum(rank != 1)*100)
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 3) %>%
summarise(first_rank = sum(rank == 1)/sum(rank != 1)*100)
dax_transform %>%
group_by(trading_day) %>%
filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 1)/sum(rank != 1)*100)
dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 1)/sum(rank != 1)*100)
dax_mean_perc <- dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 1)/sum(rank != 1)*100)
View(dax_mean_perc)
dax_mean_perc <- dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 10)/sum(rank != 10)*100)
dax_mean_perc <- dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 17)/sum(rank != 17)*100)
dax_mean_perc <- dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 5)/sum(rank != 5)*100)
#----------------------------------------------------------------------------
# Transform data
#----------------------------------------------------------------------------
dax_transform <- dax %>%
drop_na() %>%
select(1, 2, 3) %>%
mutate(ym = substr(date, 1, 7)) %>%
mutate(day = substr(date, 9, 10)) %>%
mutate(weekday = weekdays.POSIXt(date, abbreviate = TRUE)) %>%
mutate(weekday = factor(weekday, levels = c("Mon", "Tue", "Wed", "Thu", "Fri"))) %>%
group_by(ym) %>%
mutate(trading_day = row_number()) %>%
#  filter(trading_day <= 17) %>% # all months have at least 17 trading days
mutate(rank = rank(open, ties.method = "random"))
View(dax_transform)
dax_mean_perc <- dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 20)/sum(rank != 20)*100)
dax_transform %>%
filter(rank <= 1)
dax_transform %>%
filter(rank <= 1) %>% mutate(count = count(trading_day))
dax_transform %>%
filter(rank <= 1) %>% mutate(count = sum(trading_day))
dax_transform %>%
ungroup() %>%
filter(rank <= 1)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
#----------------------------------------------------------------------------
# Transform data
#----------------------------------------------------------------------------
dax_transform <- dax %>%
drop_na() %>%
select(1, 2, 3) %>%
mutate(ym = substr(date, 1, 7)) %>%
mutate(day = substr(date, 9, 10)) %>%
mutate(weekday = weekdays.POSIXt(date, abbreviate = TRUE)) %>%
mutate(weekday = factor(weekday, levels = c("Mon", "Tue", "Wed", "Thu", "Fri"))) %>%
group_by(ym) %>%
mutate(trading_day = row_number()) %>%
#  filter(trading_day <= 17) %>% # all months have at least 17 trading days
mutate(rank = rank(open, ties.method = "random")) %>%
ungroup()
dax_transform %>%
filter(rank <= 1)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(rank <= 1)
dax_transform %>%
filter(rank <= 1) %>% summarise(trading_day)
dax_transform_first <- dax_transform %>%
filter(rank <= 1)
View(dax_transform_first)
dax_mean_perc <- dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 1)/sum(rank != 1)*100)
sum(dax_mean_perc$first_rank)
dax_mean_perc <- dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 1)/sum(rank)*100)
dax_mean_perc <- dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 1)/sum(rank)*100)
dax_mean_perc <- dax_transform %>%
group_by(trading_day) %>%
# filter(trading_day == 4) %>%
summarise(first_rank = sum(rank == 1)/sum(rank >= 0)*100)
sum(dax_mean_perc$first_rank)
dax_transform %>%
filter(rank <= 1)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(rank <= 1)  %>%
group_by(rank) %>%
summarise(n())
dax_transform %>%
filter(rank <= 1)  %>%
group_by(trading_day) %>%
summarise(n())
dax_transform %>%
filter(date < "1990-12-31") %>%
filter(rank <= 1)  %>%
group_by(trading_day) %>%
summarise(n())
dax_transform %>%
filter(date < "1991-12-31") %>%
filter(rank <= 1)  %>%
group_by(trading_day) %>%
summarise(n())
dax_transform %>%
filter(date < "1991-12-31") %>%
filter(rank <= 1)  %>%
group_by(trading_day) %>%
summarise(count = n()) %>%
mutate(sum = sum(count))
dax_transform %>%
filter(date < "1992-12-31") %>%
filter(rank <= 1)  %>%
group_by(trading_day) %>%
summarise(count = n()) %>%
mutate(sum = sum(count))
dax_transform %>%
filter(date < "1992-12-31") %>%
filter(rank <= 5)  %>%
group_by(trading_day) %>%
summarise(count = n()) %>%
mutate(sum = sum(count))
dax_transform %>%
filter(date < "1992-12-31") %>%
filter(rank   == 5)  %>%
group_by(trading_day) %>%
summarise(count = n()) %>%
mutate(sum = sum(count))
dax_transform %>%
filter(rank == 5)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1992-12-31") %>%
filter(rank == 5)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank   == 5)  %>%
group_by(trading_day) %>%
summarise(count = n()) %>%
mutate(sum = sum(count))
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 5)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 1)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 2)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 6)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 5)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 7)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 17)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 20)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 25)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
dax_transform %>%
filter(date < "1999-12-31") %>%
filter(rank == 8)  %>%
filter(trading_day <= 18) %>%
ggplot(aes(x = trading_day)) +
geom_bar()
n <- getSymbols("^NDX", from = Sys.Date() - years(3), auto.assign = FALSE)
View(n)
hchart(n, type = "ohlc") %>%
hc_title(text = "This is a Open-high-low-close chart with a custom theme")
n %>%
highchart(type = "stock")
n %>%
highchart(type = "stock") %>%
hc_add_series(n)
n %>%
highchart(type = "stock") %>%
hc_add_series(n, id = "usdjpy", name = "USD/JPY")
class(n)
highchart(type = "stock") %>%
hc_add_series(n, id = "usdjpy", name = "USD/JPY")
hchart(n, type = "ohlc") %>%
hc_title(text = "This is a Open-high-low-close chart with a custom theme")
hchart(n, type = "line") %>%
hc_title(text = "This is a Open-high-low-close chart with a custom theme")
hchart(n, type = "line") %>%
hc_title(text = "Konventionelle Darstellung vom Nasdaq 100") %>%
hc_subtitle(text = "3 Dimensionen: Kursstand, 3 Jahre Zeitverlauf") %>%
hc_caption(text = caption_text)
hc <- hchart(n, type = "line") %>%
hc_title(text = "Konventionelle Darstellung vom Nasdaq 100") %>%
hc_subtitle(text = "3 Dimensionen: Kursstand, 3 Jahre Zeitverlauf") %>%
hc_caption(text = caption_text)
saveWidget(hc, file = "nasdaq_line_chart.html", selfcontained = TRUE)
blogdown:::preview_site()
hc <- hchart(n, type = "line") %>%
hc_title(text = "Konventionelle Darstellung vom Nasdaq 100") %>%
hc_subtitle(text = "2 Dimensionen: Kursstand, 3 Jahre Zeitverlauf") %>%
hc_caption(text = caption_text)
# Load in header file
source("/Users/jan/blog/jantau/content/post/header.R")
hc <- hchart(n, type = "line") %>%
hc_title(text = "Konventionelle Darstellung vom Nasdaq 100") %>%
hc_subtitle(text = "2 Dimensionen: Kursstand, 3 Jahre Zeitverlauf") %>%
hc_caption(text = caption_text)
saveWidget(hc, file = "nasdaq_line_chart.html", selfcontained = TRUE)
